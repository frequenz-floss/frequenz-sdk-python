
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="A development kit to interact with the Frequenz development platform">
      
      
        <meta name="author" content="Frequenz Energy-as-a-Service GmbH">
      
      
      
        <link rel="prev" href="../">
      
      
        <link rel="next" href="../formula-engine/">
      
      
      <link rel="icon" href="../../_img/logo.png">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.26">
    
    
      
        <title>Actors - Frequenz Python SDK</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.6543a935.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../_css/style.css">
    
      <link rel="stylesheet" href="../../_css/mkdocstrings.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="deep-purple">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#actors" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
          <aside class="md-banner md-banner--warning">
            <div class="md-banner__inner md-grid md-typeset">
              
  You're not viewing the latest (stable) version.
  <a href="../../..">
    <strong>Click here to go to latest (stable) version</strong>
  </a>

            </div>
            <script>var el=document.querySelector("[data-md-component=outdated]"),outdated=__md_get("__outdated",sessionStorage);!0===outdated&&el&&(el.hidden=!1)</script>
          </aside>
        
      </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Frequenz Python SDK" class="md-header__button md-logo" aria-label="Frequenz Python SDK" data-md-component="logo">
      
  <img src="../../_img/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Frequenz Python SDK
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Actors
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="deep-purple"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5c-.84 0-1.65.15-2.39.42L12 2M3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29L3.34 7m.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14L3.36 17M20.65 7l-1.77 3.79a7.023 7.023 0 0 0-2.38-4.15l4.15.36m-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29L20.64 17M12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44L12 22Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="teal"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3 3.19.09m3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95 2.06.05m-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/frequenz-floss/frequenz-sdk-python" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    frequenz-sdk-python
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../" class="md-tabs__link">
          
  
    
  
  User Guide

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../tutorials/getting_started/" class="md-tabs__link">
          
  
    
  
  Tutorials

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      
  
  
  
    
    
      
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../reference/frequenz/sdk/" class="md-tabs__link">
          
  
    
  
  API Reference

        </a>
      </li>
    
  

    
  

    
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../CONTRIBUTING/" class="md-tabs__link">
        
  
    
  
  Contributing

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Frequenz Python SDK" class="md-nav__button md-logo" aria-label="Frequenz Python SDK" data-md-component="logo">
      
  <img src="../../_img/logo.png" alt="logo">

    </a>
    Frequenz Python SDK
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/frequenz-floss/frequenz-sdk-python" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    frequenz-sdk-python
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    User Guide
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2" id="__nav_2_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            User Guide
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Actors
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Actors
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#frequenz.sdk.actor--actor-programming-model" class="md-nav__link">
    <span class="md-ellipsis">
      Actor Programming Model
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#frequenz.sdk.actor--frequenz-sdk-actors" class="md-nav__link">
    <span class="md-ellipsis">
      Frequenz SDK Actors
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#frequenz.sdk.actor--lifecycle" class="md-nav__link">
    <span class="md-ellipsis">
      Lifecycle
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Lifecycle">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#frequenz.sdk.actor--the-run-function" class="md-nav__link">
    <span class="md-ellipsis">
      The run() Function
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.sdk.actor--async-context-manager" class="md-nav__link">
    <span class="md-ellipsis">
      Async Context Manager
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.sdk.actor--the-start-method" class="md-nav__link">
    <span class="md-ellipsis">
      The start() Method
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#frequenz.sdk.actor--communication" class="md-nav__link">
    <span class="md-ellipsis">
      Communication
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#frequenz.sdk.actor--implementing-an-actor" class="md-nav__link">
    <span class="md-ellipsis">
      Implementing an Actor
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Implementing an Actor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#frequenz.sdk.actor--initialization" class="md-nav__link">
    <span class="md-ellipsis">
      Initialization
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.sdk.actor--the-_run-method" class="md-nav__link">
    <span class="md-ellipsis">
      The _run() Method
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.sdk.actor--stopping" class="md-nav__link">
    <span class="md-ellipsis">
      Stopping
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.sdk.actor--spawning-extra-tasks" class="md-nav__link">
    <span class="md-ellipsis">
      Spawning Extra Tasks
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.sdk.actor--examples" class="md-nav__link">
    <span class="md-ellipsis">
      Examples
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Examples">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#frequenz.sdk.actor--composing-actors" class="md-nav__link">
    <span class="md-ellipsis">
      Composing actors
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.sdk.actor--receiving-from-multiple-channels" class="md-nav__link">
    <span class="md-ellipsis">
      Receiving from multiple channels
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../formula-engine/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Formula Engine
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../glossary/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Glossary
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../microgrid-concepts/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Microgrid Concepts
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Tutorials
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Tutorials
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../tutorials/getting_started/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Getting started
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    API Reference
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            API Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1" >
        
          
          <label class="md-nav__link" for="__nav_4_1" id="__nav_4_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    frequenz
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1">
            <span class="md-nav__icon md-icon"></span>
            frequenz
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
          
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1_1" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../reference/frequenz/sdk/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    sdk
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4_1_1" id="__nav_4_1_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_4_1_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1_1">
            <span class="md-nav__icon md-icon"></span>
            sdk
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1_1_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../reference/frequenz/sdk/actor/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    actor
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4_1_1_2" id="__nav_4_1_1_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_4_1_1_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1_1_2">
            <span class="md-nav__icon md-icon"></span>
            actor
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1_1_2_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../reference/frequenz/sdk/actor/power_distributing/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    power_distributing
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4_1_1_2_2" id="__nav_4_1_1_2_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="5" aria-labelledby="__nav_4_1_1_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1_1_2_2">
            <span class="md-nav__icon md-icon"></span>
            power_distributing
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/frequenz/sdk/actor/power_distributing/power_distributing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    power_distributing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/frequenz/sdk/actor/power_distributing/request/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    request
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/frequenz/sdk/actor/power_distributing/result/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    result
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/frequenz/sdk/config/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    config
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1_1_4" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../reference/frequenz/sdk/microgrid/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    microgrid
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4_1_1_4" id="__nav_4_1_1_4_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_4_1_1_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1_1_4">
            <span class="md-nav__icon md-icon"></span>
            microgrid
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/frequenz/sdk/microgrid/component_graph/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    component_graph
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/frequenz/sdk/microgrid/connection_manager/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    connection_manager
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
          
        
      
        
      
        
          
        
      
        
          
        
      
        
      
        
          
        
      
        
      
        
          
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_1_1_5" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../reference/frequenz/sdk/timeseries/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    timeseries
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4_1_1_5" id="__nav_4_1_1_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="4" aria-labelledby="__nav_4_1_1_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1_1_5">
            <span class="md-nav__icon md-icon"></span>
            timeseries
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/frequenz/sdk/timeseries/battery_pool/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    battery_pool
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/frequenz/sdk/timeseries/consumer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    consumer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/frequenz/sdk/timeseries/ev_charger_pool/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ev_charger_pool
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/frequenz/sdk/timeseries/formula_engine/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    formula_engine
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/frequenz/sdk/timeseries/grid/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    grid
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/frequenz/sdk/timeseries/logical_meter/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    logical_meter
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/frequenz/sdk/timeseries/producer/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    producer
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../reference/frequenz/sdk/timeseries/pv_pool/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    pv_pool
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../CONTRIBUTING/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Contributing
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#frequenz.sdk.actor--actor-programming-model" class="md-nav__link">
    <span class="md-ellipsis">
      Actor Programming Model
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#frequenz.sdk.actor--frequenz-sdk-actors" class="md-nav__link">
    <span class="md-ellipsis">
      Frequenz SDK Actors
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#frequenz.sdk.actor--lifecycle" class="md-nav__link">
    <span class="md-ellipsis">
      Lifecycle
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Lifecycle">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#frequenz.sdk.actor--the-run-function" class="md-nav__link">
    <span class="md-ellipsis">
      The run() Function
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.sdk.actor--async-context-manager" class="md-nav__link">
    <span class="md-ellipsis">
      Async Context Manager
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.sdk.actor--the-start-method" class="md-nav__link">
    <span class="md-ellipsis">
      The start() Method
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#frequenz.sdk.actor--communication" class="md-nav__link">
    <span class="md-ellipsis">
      Communication
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#frequenz.sdk.actor--implementing-an-actor" class="md-nav__link">
    <span class="md-ellipsis">
      Implementing an Actor
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Implementing an Actor">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#frequenz.sdk.actor--initialization" class="md-nav__link">
    <span class="md-ellipsis">
      Initialization
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.sdk.actor--the-_run-method" class="md-nav__link">
    <span class="md-ellipsis">
      The _run() Method
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.sdk.actor--stopping" class="md-nav__link">
    <span class="md-ellipsis">
      Stopping
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.sdk.actor--spawning-extra-tasks" class="md-nav__link">
    <span class="md-ellipsis">
      Spawning Extra Tasks
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.sdk.actor--examples" class="md-nav__link">
    <span class="md-ellipsis">
      Examples
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Examples">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#frequenz.sdk.actor--composing-actors" class="md-nav__link">
    <span class="md-ellipsis">
      Composing actors
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#frequenz.sdk.actor--receiving-from-multiple-channels" class="md-nav__link">
    <span class="md-ellipsis">
      Receiving from multiple channels
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="actors">Actors<a class="headerlink" href="#actors" title="Permanent link">¤</a></h1>


<div class="doc doc-object doc-module">




    <div class="doc doc-contents first">

      <p>Actors are a primitive unit of computation that runs autonomously.</p>
<h3 id="frequenz.sdk.actor--actor-programming-model">Actor Programming Model<a class="headerlink" href="#frequenz.sdk.actor--actor-programming-model" title="Permanent link">¤</a></h3>
<div class="admonition quote">
<p class="admonition-title">From <a href="https://en.wikipedia.org/wiki/Actor_model">Wikipedia</a></p>
<p>The actor model in computer science is a mathematical model of concurrent
computation that treats an actor as the basic building block of concurrent
computation. In response to a message it receives, an actor can: make local
decisions, create more actors, send more messages, and determine how to
respond to the next message received. Actors may modify their own private
state, but can only affect each other indirectly through messaging (removing
the need for lock-based synchronization).</p>
</div>
<p>We won't get into much more detail here because it is outside the scope of this
documentation. However, if you are interested in learning more about the actor
programming model, here are some useful resources:</p>
<ul>
<li><a href="https://en.wikipedia.org/wiki/Actor_model">Actor Model (Wikipedia)</a></li>
<li><a href="https://doc.akka.io/docs/akka/current/typed/guide/actors-intro.html">How the Actor Model Meets the Needs of Modern, Distributed Systems
  (Akka)</a></li>
</ul>
<h3 id="frequenz.sdk.actor--frequenz-sdk-actors">Frequenz SDK Actors<a class="headerlink" href="#frequenz.sdk.actor--frequenz-sdk-actors" title="Permanent link">¤</a></h3>
<p>The <a class="autorefs autorefs-internal" href="../../reference/frequenz/sdk/actor/#frequenz.sdk.actor.Actor"><code>Actor</code></a> class serves as the foundation for
creating concurrent tasks and all actors in the SDK inherit from it. This class
provides a straightforward way to implement actors. It shares similarities with
the traditional actor programming model but also has some unique features:</p>
<ul>
<li>
<p><strong>Message Passing:</strong> Like traditional actors, our <a class="autorefs autorefs-internal" href="../../reference/frequenz/sdk/actor/#frequenz.sdk.actor.Actor"><code>Actor</code></a>
  class communicates through message passing. Even when no particular message passing
  mechanism is enforced, the SDK actors use <a class="autorefs autorefs-external" href="https://frequenz-floss.github.io/frequenz-channels-python/v0.16/reference/frequenz/channels/#frequenz.channels"><code>frequenz.channels</code></a> for communication.</p>
</li>
<li>
<p><strong>Automatic Restart:</strong> If an unhandled exception occurs in an actor's logic
  (<a href="#frequenz.sdk.actor--the-_run-method"><code>_run()</code></a> method), the actor will be automatically restarted. This ensures
  robustness in the face of errors.</p>
</li>
<li>
<p><strong>Simplified Task Management:</strong> Actors manage asynchronous tasks using
  <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/asyncio.html#module-asyncio"><code>asyncio</code></a>. You can create and manage tasks within the actor, and the
  <a class="autorefs autorefs-internal" href="../../reference/frequenz/sdk/actor/#frequenz.sdk.actor.Actor"><code>Actor</code></a> class handles task cancellation and cleanup.</p>
</li>
<li>
<p><strong>Simplified lifecycle management:</strong> Actors are [async context managers] and also
  a <a class="autorefs autorefs-internal" href="../../reference/frequenz/sdk/actor/#frequenz.sdk.actor.run"><code>run()</code></a> function is provided to easily run a group of
  actors and wait for them to finish.</p>
</li>
</ul>
<h3 id="frequenz.sdk.actor--lifecycle">Lifecycle<a class="headerlink" href="#frequenz.sdk.actor--lifecycle" title="Permanent link">¤</a></h3>
<p>Actors are not started when they are created. There are 3 main ways to start an actor
(from most to least recommended):</p>
<ol>
<li>By using the <a class="autorefs autorefs-internal" href="../../reference/frequenz/sdk/actor/#frequenz.sdk.actor.run"><code>run()</code></a> function.</li>
<li>By using the actor as an <a href="https://docs.python.org/3/reference/datamodel.html#async-context-managers">async context manager</a>.</li>
<li>By using the <a class="autorefs autorefs-internal" href="../../reference/frequenz/sdk/actor/#frequenz.sdk.actor.Actor.start"><code>start()</code></a> method.</li>
</ol>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<ol>
<li>
<p>If an actor raises an unhandled exception, it will be restarted automatically.</p>
</li>
<li>
<p>Actors manage <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/asyncio-task.html#asyncio.Task"><code>asyncio.Task</code></a> objects, so a reference to the actor object must
   be held for as long as the actor is expected to be running, otherwise its tasks
   will be cancelled and the actor will stop. For more information, please refer to
   the <a href="https://docs.python.org/3/library/asyncio-task.html#asyncio.create_task">Python <code>asyncio</code>
   documentation</a>.</p>
</li>
</ol>
</div>
<h4 id="frequenz.sdk.actor--the-run-function">The <code>run()</code> Function<a class="headerlink" href="#frequenz.sdk.actor--the-run-function" title="Permanent link">¤</a></h4>
<p>The <a class="autorefs autorefs-internal" href="../../reference/frequenz/sdk/actor/#frequenz.sdk.actor.run"><code>run()</code></a> function can start many actors at once and waits
for them to finish. If any of the actors is stopped with errors, the errors will be
logged.</p>
<details class="example" open="open">
<summary>Example</summary>
<div class="language-python highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="kn">from</span> <span class="nn">frequenz.sdk.actor</span> <span class="kn">import</span> <span class="n">Actor</span><span class="p">,</span> <span class="n">run</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="k">class</span> <span class="nc">MyActor</span><span class="p">(</span><span class="n">Actor</span><span class="p">):</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">_run</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Hello World!&quot;</span><span class="p">)</span>
</span><span id="__span-0-6"><a id="__codelineno-0-6" name="__codelineno-0-6" href="#__codelineno-0-6"></a>
</span><span id="__span-0-7"><a id="__codelineno-0-7" name="__codelineno-0-7" href="#__codelineno-0-7"></a><span class="k">await</span> <span class="n">run</span><span class="p">(</span><span class="n">MyActor</span><span class="p">())</span> <span class="c1"># (1)!</span>
</span></code></pre></div>
<ol>
<li>This line will block until the actor completes its execution or is manually stopped.</li>
</ol>
</details>
<h4 id="frequenz.sdk.actor--async-context-manager">Async Context Manager<a class="headerlink" href="#frequenz.sdk.actor--async-context-manager" title="Permanent link">¤</a></h4>
<p>When an actor is used as an <a href="https://docs.python.org/3/reference/datamodel.html#async-context-managers">async context manager</a>, it is started when the
<code>async with</code> block is entered and stopped automatically when the block is exited
(even if an unhandled exception is raised).</p>
<details class="example" open="open">
<summary>Example</summary>
<div class="language-python highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="kn">from</span> <span class="nn">frequenz.sdk.actor</span> <span class="kn">import</span> <span class="n">Actor</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="k">class</span> <span class="nc">MyActor</span><span class="p">(</span><span class="n">Actor</span><span class="p">):</span>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">_run</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Hello World!&quot;</span><span class="p">)</span>
</span><span id="__span-1-6"><a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a>
</span><span id="__span-1-7"><a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a><span class="k">async</span> <span class="k">with</span> <span class="n">MyActor</span><span class="p">()</span> <span class="k">as</span> <span class="n">actor</span><span class="p">:</span> <span class="c1"># (1)!</span>
</span><span id="__span-1-8"><a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The actor is running&quot;</span><span class="p">)</span>
</span><span id="__span-1-9"><a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a><span class="c1"># (2)!</span>
</span></code></pre></div>
<ol>
<li><a class="autorefs autorefs-internal" href="../../reference/frequenz/sdk/actor/#frequenz.sdk.actor.Actor.start"><code>start()</code></a> is called automatically when entering
    the <code>async with</code> block.</li>
<li><a class="autorefs autorefs-internal" href="../../reference/frequenz/sdk/actor/#frequenz.sdk.actor.Actor.stop"><code>stop()</code></a> is called automatically when exiting
    the <code>async with</code> block.</li>
</ol>
</details>
<h4 id="frequenz.sdk.actor--the-start-method">The <code>start()</code> Method<a class="headerlink" href="#frequenz.sdk.actor--the-start-method" title="Permanent link">¤</a></h4>
<p>When using the <a class="autorefs autorefs-internal" href="../../reference/frequenz/sdk/actor/#frequenz.sdk.actor.Actor.start"><code>start()</code></a> method, the actor is
started in the background and the method returns immediately. The actor will
continue to run until it is <strong>manually</strong> stopped or until it completes its execution.</p>
<details class="example" open="open">
<summary>Example</summary>
<div class="language-python highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="kn">from</span> <span class="nn">frequenz.sdk.actor</span> <span class="kn">import</span> <span class="n">Actor</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="k">class</span> <span class="nc">MyActor</span><span class="p">(</span><span class="n">Actor</span><span class="p">):</span>
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">_run</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Hello World!&quot;</span><span class="p">)</span>
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a>
</span><span id="__span-2-7"><a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a><span class="n">actor</span> <span class="o">=</span> <span class="n">MyActor</span><span class="p">()</span> <span class="c1"># (1)!</span>
</span><span id="__span-2-8"><a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a><span class="n">actor</span><span class="o">.</span><span class="n">start</span><span class="p">()</span> <span class="c1"># (2)!</span>
</span><span id="__span-2-9"><a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The actor is running&quot;</span><span class="p">)</span> <span class="c1"># (3)!</span>
</span><span id="__span-2-10"><a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a><span class="k">await</span> <span class="n">actor</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span> <span class="c1"># (4)!</span>
</span></code></pre></div>
<ol>
<li>The actor is created but not started yet.</li>
<li>The actor is started manually, it keeps running in the background.</li>
<li>
<div class="admonition danger">
<p class="admonition-title">Danger</p>
</div>
<p>If this function would raise an exception, the actor will never be stopped!</p>
</li>
<li>
<p>Until the actor is stopped manually.</p>
</li>
</ol>
</details>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This method is not recommended because it is easy to forget to stop the actor
manually, especially in error conditions.</p>
</div>
<h3 id="frequenz.sdk.actor--communication">Communication<a class="headerlink" href="#frequenz.sdk.actor--communication" title="Permanent link">¤</a></h3>
<p>The <a class="autorefs autorefs-internal" href="../../reference/frequenz/sdk/actor/#frequenz.sdk.actor.Actor"><code>Actor</code></a> class doesn't impose any specific way to
communicate between actors. However, <a class="autorefs autorefs-external" href="https://frequenz-floss.github.io/frequenz-channels-python/v0.16/reference/frequenz/channels/#frequenz.channels"><code>frequenz.channels</code></a> are always used as the
communication mechanism between actors in the SDK.</p>
<h3 id="frequenz.sdk.actor--implementing-an-actor">Implementing an Actor<a class="headerlink" href="#frequenz.sdk.actor--implementing-an-actor" title="Permanent link">¤</a></h3>
<p>To implement an actor, you must inherit from the <a class="autorefs autorefs-internal" href="../../reference/frequenz/sdk/actor/#frequenz.sdk.actor.Actor"><code>Actor</code></a>
class and implement an <em>initializer</em> and the abstract <a href="#frequenz.sdk.actor--the-_run-method"><code>_run()</code></a> method.</p>
<h4 id="frequenz.sdk.actor--initialization">Initialization<a class="headerlink" href="#frequenz.sdk.actor--initialization" title="Permanent link">¤</a></h4>
<p>The <a class="autorefs autorefs-external" href="https://docs.python.org/3/reference/datamodel.html#object.__init__">initializer</a> is called when the actor is created. The
<a class="autorefs autorefs-internal" href="../../reference/frequenz/sdk/actor/#frequenz.sdk.actor.Actor"><code>Actor</code></a> class initializer
(<a class="autorefs autorefs-internal" href="../../reference/frequenz/sdk/actor/#frequenz.sdk.actor.Actor.__init__"><code>__init__</code></a>) should be always called first in the
class we are implementing to make sure actors are properly initialized.</p>
<p>The <a class="autorefs autorefs-internal" href="../../reference/frequenz/sdk/actor/#frequenz.sdk.actor.Actor.__init__"><code>Actor.__init__()</code></a> takes one optional argument,
a <a class="autorefs autorefs-internal" href="../../reference/frequenz/sdk/actor/#frequenz.sdk.actor.Actor.name"><code>name</code></a> that will be used to identify the actor in
logs. If no name is provided, a default name will be generated, but it is recommended
that <a class="autorefs autorefs-internal" href="../../reference/frequenz/sdk/actor/#frequenz.sdk.actor.Actor"><code>Actor</code></a> subclasses can also receive a name as an
argument to make it easier to identify individual instances in logs more easily.</p>
<p>The actor initializer normally also accepts as arguments the input channels receivers
and output channels senders that will be used for communication. These channels should
be created outside the actor and passed to it as arguments to ensure actors can be
composed easily.</p>
<details class="example" open="open">
<summary>Example echo actor</summary>
<div class="language-python highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="kn">from</span> <span class="nn">frequenz.channels</span> <span class="kn">import</span> <span class="n">Receiver</span><span class="p">,</span> <span class="n">Sender</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="kn">from</span> <span class="nn">frequenz.sdk.actor</span> <span class="kn">import</span> <span class="n">Actor</span>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a><span class="k">class</span> <span class="nc">EchoActor</span><span class="p">(</span><span class="n">Actor</span><span class="p">):</span>  <span class="c1"># (1)!</span>
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="__span-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a>            <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-3-7"><a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a>            <span class="nb">input</span><span class="p">:</span> <span class="n">Receiver</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span>  <span class="c1"># (2)!</span>
</span><span id="__span-3-8"><a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a>            <span class="n">output</span><span class="p">:</span> <span class="n">Sender</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span>  <span class="c1"># (3)!</span>
</span><span id="__span-3-9"><a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a>            <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>  <span class="c1"># (4)!</span>
</span><span id="__span-3-10"><a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-3-11"><a id="__codelineno-3-11" name="__codelineno-3-11" href="#__codelineno-3-11"></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span> <span class="c1"># (5)!</span>
</span><span id="__span-3-12"><a id="__codelineno-3-12" name="__codelineno-3-12" href="#__codelineno-3-12"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_input</span><span class="p">:</span> <span class="n">Receiver</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="nb">input</span>  <span class="c1"># (6)!</span>
</span><span id="__span-3-13"><a id="__codelineno-3-13" name="__codelineno-3-13" href="#__codelineno-3-13"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_output</span><span class="p">:</span> <span class="n">Sender</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">output</span>  <span class="c1"># (7)!</span>
</span></code></pre></div>
<ol>
<li>
<p>We define a new actor class called <code>EchoActor</code> that inherits from
    <a class="autorefs autorefs-internal" href="../../reference/frequenz/sdk/actor/#frequenz.sdk.actor.Actor"><code>Actor</code></a>.</p>
</li>
<li>
<p>We accept an <code>input</code> argument that will be used to receive messages from
    a channel.</p>
</li>
<li>We accept an <code>output</code> argument that will be used to send messages to a channel.</li>
<li>We accept an optional <code>name</code> argument that will be used to identify the actor in
    logs.</li>
<li>We call <a class="autorefs autorefs-internal" href="../../reference/frequenz/sdk/actor/#frequenz.sdk.actor.Actor.__init__"><code>Actor.__init__()</code></a> to make sure the
    actor is properly initialized.</li>
<li>We store the <code>input</code> argument in a <em>private</em> attribute to use it later.</li>
<li>We store the <code>output</code> argument in a <em>private</em> attribute to use it later.</li>
</ol>
</details>
<h4 id="frequenz.sdk.actor--the-_run-method">The <code>_run()</code> Method<a class="headerlink" href="#frequenz.sdk.actor--the-_run-method" title="Permanent link">¤</a></h4>
<p>The abstract <code>_run()</code> method is called automatically by the base class when the actor is
<a class="autorefs autorefs-internal" href="../../reference/frequenz/sdk/actor/#frequenz.sdk.actor.Actor.start">started</a>.</p>
<p>Normally an actor should run forever (or until it is
<a class="autorefs autorefs-internal" href="../../reference/frequenz/sdk/actor/#frequenz.sdk.actor.Actor.stop">stopped</a>), so it is very common to have an infinite loop
in the <code>_run()</code> method, typically receiving messages from one or more channels
(<a class="autorefs autorefs-external" href="https://frequenz-floss.github.io/frequenz-channels-python/v0.16/reference/frequenz/channels/#frequenz.channels.Receiver">receivers</a>), processing them and sending the results to
other channels (<a class="autorefs autorefs-external" href="https://frequenz-floss.github.io/frequenz-channels-python/v0.16/reference/frequenz/channels/#frequenz.channels.Sender">senders</a>).
However, it is worth noting that an actor can also be designed for a one-time execution
or a limited number of runs, terminating upon completion.</p>
<details class="example" open="open">
<summary>Example echo actor</summary>
<div class="language-python highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="kn">from</span> <span class="nn">frequenz.channels</span> <span class="kn">import</span> <span class="n">Receiver</span><span class="p">,</span> <span class="n">Sender</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="kn">from</span> <span class="nn">frequenz.sdk.actor</span> <span class="kn">import</span> <span class="n">Actor</span>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a><span class="k">class</span> <span class="nc">EchoActor</span><span class="p">(</span><span class="n">Actor</span><span class="p">):</span>
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a>            <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-4-7"><a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a>            <span class="nb">input</span><span class="p">:</span> <span class="n">Receiver</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span>
</span><span id="__span-4-8"><a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a>            <span class="n">output</span><span class="p">:</span> <span class="n">Sender</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span>
</span><span id="__span-4-9"><a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a>            <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-4-10"><a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-4-11"><a id="__codelineno-4-11" name="__codelineno-4-11" href="#__codelineno-4-11"></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
</span><span id="__span-4-12"><a id="__codelineno-4-12" name="__codelineno-4-12" href="#__codelineno-4-12"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_input</span><span class="p">:</span> <span class="n">Receiver</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="nb">input</span>
</span><span id="__span-4-13"><a id="__codelineno-4-13" name="__codelineno-4-13" href="#__codelineno-4-13"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_output</span><span class="p">:</span> <span class="n">Sender</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">output</span>
</span><span id="__span-4-14"><a id="__codelineno-4-14" name="__codelineno-4-14" href="#__codelineno-4-14"></a>
</span><span id="__span-4-15"><a id="__codelineno-4-15" name="__codelineno-4-15" href="#__codelineno-4-15"></a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">_run</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># (1)!</span>
</span><span id="__span-4-16"><a id="__codelineno-4-16" name="__codelineno-4-16" href="#__codelineno-4-16"></a>        <span class="k">async</span> <span class="k">for</span> <span class="n">msg</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_input</span><span class="p">:</span>  <span class="c1"># (2)!</span>
</span><span id="__span-4-17"><a id="__codelineno-4-17" name="__codelineno-4-17" href="#__codelineno-4-17"></a>            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_output</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>  <span class="c1"># (3)!</span>
</span></code></pre></div>
<ol>
<li>We implement the abstract <a href="#frequenz.sdk.actor--the-_run-method"><code>_run()</code></a> method.</li>
<li>We receive messages from the <code>input</code> channel one by one.</li>
<li>We send the received message to the <code>output</code> channel.</li>
</ol>
</details>
<h4 id="frequenz.sdk.actor--stopping">Stopping<a class="headerlink" href="#frequenz.sdk.actor--stopping" title="Permanent link">¤</a></h4>
<p>By default, the <a class="autorefs autorefs-internal" href="../../reference/frequenz/sdk/actor/#frequenz.sdk.actor.Actor.stop"><code>stop()</code></a> method will call the
<a class="autorefs autorefs-internal" href="../../reference/frequenz/sdk/actor/#frequenz.sdk.actor.Actor.cancel"><code>cancel()</code></a> method (which will cancel all the tasks
created by the actor) and will wait for them to finish.</p>
<p>This means that when an actor is stopped, the <a href="#frequenz.sdk.actor--the-_run-method"><code>_run()</code></a> method will receive
a <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/asyncio-exceptions.html#asyncio.CancelledError"><code>CancelledError</code></a> exception. You should have this in mind
when implementing your actor and make sure to handle this exception properly if you need
to do any cleanup.</p>
<p>The actor will handle the <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/asyncio-exceptions.html#asyncio.CancelledError"><code>CancelledError</code></a> exception
automatically if it is not handled in the <a href="#frequenz.sdk.actor--the-_run-method"><code>_run()</code></a> method, so if there is no
need for extra cleanup, you don't need to worry about it.</p>
<p>If an unhandled exception is raised in the <a href="#frequenz.sdk.actor--the-_run-method"><code>_run()</code></a> method, the actor will
re-run the <a href="#frequenz.sdk.actor--the-_run-method"><code>_run()</code></a> method automatically. This ensures robustness in the face of
errors, but you should also have this in mind if you need to do any cleanup to make sure
the re-run doesn't cause any problems.</p>
<details class="tip" open="open">
<summary>Tip</summary>
<p>You could implement your own <a class="autorefs autorefs-internal" href="../../reference/frequenz/sdk/actor/#frequenz.sdk.actor.Actor.stop"><code>stop()</code></a> method to,
for example, send a message to a channel to notify that the actor should stop, or
any other more graceful way to stop the actor if you need to make sure it can't be
interrupted at any <code>await</code> point.</p>
</details>
<h4 id="frequenz.sdk.actor--spawning-extra-tasks">Spawning Extra Tasks<a class="headerlink" href="#frequenz.sdk.actor--spawning-extra-tasks" title="Permanent link">¤</a></h4>
<p>Actors run at least one background task, created automatically by the
<a class="autorefs autorefs-internal" href="../../reference/frequenz/sdk/actor/#frequenz.sdk.actor.Actor"><code>Actor</code></a> class. But <a class="autorefs autorefs-internal" href="../../reference/frequenz/sdk/actor/#frequenz.sdk.actor.Actor"><code>Actor</code></a>
inherits from <a class="autorefs autorefs-internal" href="../../reference/frequenz/sdk/actor/#frequenz.sdk.actor.BackgroundService"><code>BackgroundService</code></a>, which
provides a few methods to create and manage extra tasks.</p>
<p>If your actor needs to spawn extra tasks, you can use
<a class="autorefs autorefs-internal" href="../../reference/frequenz/sdk/actor/#frequenz.sdk.actor.BackgroundService"><code>BackgroundService</code></a> facilities to manage the
tasks, so they are also automatically stopped when the actor is stopped.</p>
<p>All you need to do is add the newly spawned tasks to the actor's
<a class="autorefs autorefs-internal" href="../../reference/frequenz/sdk/actor/#frequenz.sdk.actor.Actor.tasks"><code>tasks</code></a> set.</p>
<details class="example" open="open">
<summary>Example</summary>
<div class="language-python highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="kn">import</span> <span class="nn">asyncio</span>
</span><span id="__span-5-2"><a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a><span class="kn">from</span> <span class="nn">frequenz.sdk.actor</span> <span class="kn">import</span> <span class="n">Actor</span>
</span><span id="__span-5-3"><a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a>
</span><span id="__span-5-4"><a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a><span class="k">class</span> <span class="nc">MyActor</span><span class="p">(</span><span class="n">Actor</span><span class="p">):</span>
</span><span id="__span-5-5"><a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">_run</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-5-6"><a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a>        <span class="n">extra_task</span> <span class="o">=</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">create_task</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_extra_task</span><span class="p">())</span>  <span class="c1"># (1)!</span>
</span><span id="__span-5-7"><a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">tasks</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">extra_task</span><span class="p">)</span>  <span class="c1"># (2)!</span>
</span><span id="__span-5-8"><a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a>        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>  <span class="c1"># (3)!</span>
</span><span id="__span-5-9"><a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;_run() running&quot;</span><span class="p">)</span>
</span><span id="__span-5-10"><a id="__codelineno-5-10" name="__codelineno-5-10" href="#__codelineno-5-10"></a>            <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</span><span id="__span-5-11"><a id="__codelineno-5-11" name="__codelineno-5-11" href="#__codelineno-5-11"></a>
</span><span id="__span-5-12"><a id="__codelineno-5-12" name="__codelineno-5-12" href="#__codelineno-5-12"></a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">_extra_task</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-5-13"><a id="__codelineno-5-13" name="__codelineno-5-13" href="#__codelineno-5-13"></a>        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>  <span class="c1"># (4)!</span>
</span><span id="__span-5-14"><a id="__codelineno-5-14" name="__codelineno-5-14" href="#__codelineno-5-14"></a>            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;_extra_task() running&quot;</span><span class="p">)</span>
</span><span id="__span-5-15"><a id="__codelineno-5-15" name="__codelineno-5-15" href="#__codelineno-5-15"></a>            <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">1.1</span><span class="p">)</span>
</span><span id="__span-5-16"><a id="__codelineno-5-16" name="__codelineno-5-16" href="#__codelineno-5-16"></a>
</span><span id="__span-5-17"><a id="__codelineno-5-17" name="__codelineno-5-17" href="#__codelineno-5-17"></a><span class="k">async</span> <span class="k">with</span> <span class="n">MyActor</span><span class="p">()</span> <span class="k">as</span> <span class="n">actor</span><span class="p">:</span>  <span class="c1"># (5)!</span>
</span><span id="__span-5-18"><a id="__codelineno-5-18" name="__codelineno-5-18" href="#__codelineno-5-18"></a>    <span class="k">await</span> <span class="n">asyncio</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>  <span class="c1"># (6)!</span>
</span><span id="__span-5-19"><a id="__codelineno-5-19" name="__codelineno-5-19" href="#__codelineno-5-19"></a><span class="c1"># (7)!</span>
</span></code></pre></div>
<ol>
<li>We create a new task using <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/asyncio-task.html#asyncio.create_task"><code>asyncio.create_task()</code></a>.</li>
<li>We add the task to the actor's <a class="autorefs autorefs-internal" href="../../reference/frequenz/sdk/actor/#frequenz.sdk.actor.Actor.tasks"><code>tasks</code></a> set.
    This ensures the task will be cancelled and cleaned up when the actor is stopped.</li>
<li>We leave the actor running forever.</li>
<li>The extra task will also run forever.</li>
<li>The actor is started.</li>
<li>We wait for 3 seconds, the actor should print a bunch of "_run() running" and
    "_extra_task() running" messages while it's running.</li>
<li>The actor is stopped and the extra task is cancelled automatically.</li>
</ol>
</details>
<h4 id="frequenz.sdk.actor--examples">Examples<a class="headerlink" href="#frequenz.sdk.actor--examples" title="Permanent link">¤</a></h4>
<p>Here are a few simple but complete examples to demonstrate how to create actors and
connect them using <a class="autorefs autorefs-external" href="https://frequenz-floss.github.io/frequenz-channels-python/v0.16/reference/frequenz/channels/#frequenz.channels">channels</a>.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>The code examples are annotated with markers (like <span class="md-annotation"><span class="md-annotation__index" tabindex="-1"><span data-md-annotation-id="1"></span></span></span>), you
can click on them to see the step-by-step explanation of what's going on. The
annotations are numbered according to the order of execution.</p>
</div>
<h5 id="frequenz.sdk.actor--composing-actors">Composing actors<a class="headerlink" href="#frequenz.sdk.actor--composing-actors" title="Permanent link">¤</a></h5>
<p>This example shows how to create two actors and connect them using
<a class="autorefs autorefs-external" href="https://frequenz-floss.github.io/frequenz-channels-python/v0.16/reference/frequenz/channels/#frequenz.channels.Broadcast">broadcast</a> channels.</p>
<div class="language-python highlight"><span class="filename">compose.py</span><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="kn">import</span> <span class="nn">asyncio</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="kn">from</span> <span class="nn">frequenz.channels</span> <span class="kn">import</span> <span class="n">Broadcast</span><span class="p">,</span> <span class="n">Receiver</span><span class="p">,</span> <span class="n">Sender</span>
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a><span class="kn">from</span> <span class="nn">frequenz.sdk.actor</span> <span class="kn">import</span> <span class="n">Actor</span>
</span><span id="__span-6-5"><a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a>
</span><span id="__span-6-6"><a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a><span class="k">class</span> <span class="nc">Actor1</span><span class="p">(</span><span class="n">Actor</span><span class="p">):</span>  <span class="c1"># (1)!</span>
</span><span id="__span-6-7"><a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="__span-6-8"><a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-6-9"><a id="__codelineno-6-9" name="__codelineno-6-9" href="#__codelineno-6-9"></a>        <span class="n">receiver</span><span class="p">:</span> <span class="n">Receiver</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
</span><span id="__span-6-10"><a id="__codelineno-6-10" name="__codelineno-6-10" href="#__codelineno-6-10"></a>        <span class="n">output</span><span class="p">:</span> <span class="n">Sender</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
</span><span id="__span-6-11"><a id="__codelineno-6-11" name="__codelineno-6-11" href="#__codelineno-6-11"></a>        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-6-12"><a id="__codelineno-6-12" name="__codelineno-6-12" href="#__codelineno-6-12"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-6-13"><a id="__codelineno-6-13" name="__codelineno-6-13" href="#__codelineno-6-13"></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
</span><span id="__span-6-14"><a id="__codelineno-6-14" name="__codelineno-6-14" href="#__codelineno-6-14"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_receiver</span> <span class="o">=</span> <span class="n">receiver</span>
</span><span id="__span-6-15"><a id="__codelineno-6-15" name="__codelineno-6-15" href="#__codelineno-6-15"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_output</span> <span class="o">=</span> <span class="n">output</span>
</span><span id="__span-6-16"><a id="__codelineno-6-16" name="__codelineno-6-16" href="#__codelineno-6-16"></a>
</span><span id="__span-6-17"><a id="__codelineno-6-17" name="__codelineno-6-17" href="#__codelineno-6-17"></a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">_run</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-6-18"><a id="__codelineno-6-18" name="__codelineno-6-18" href="#__codelineno-6-18"></a>        <span class="k">async</span> <span class="k">for</span> <span class="n">msg</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_receiver</span><span class="p">:</span>
</span><span id="__span-6-19"><a id="__codelineno-6-19" name="__codelineno-6-19" href="#__codelineno-6-19"></a>            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_output</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Actor1 forwarding: </span><span class="si">{</span><span class="n">msg</span><span class="si">!r}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># (8)!</span>
</span><span id="__span-6-20"><a id="__codelineno-6-20" name="__codelineno-6-20" href="#__codelineno-6-20"></a>
</span><span id="__span-6-21"><a id="__codelineno-6-21" name="__codelineno-6-21" href="#__codelineno-6-21"></a>
</span><span id="__span-6-22"><a id="__codelineno-6-22" name="__codelineno-6-22" href="#__codelineno-6-22"></a><span class="k">class</span> <span class="nc">Actor2</span><span class="p">(</span><span class="n">Actor</span><span class="p">):</span>
</span><span id="__span-6-23"><a id="__codelineno-6-23" name="__codelineno-6-23" href="#__codelineno-6-23"></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="__span-6-24"><a id="__codelineno-6-24" name="__codelineno-6-24" href="#__codelineno-6-24"></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-6-25"><a id="__codelineno-6-25" name="__codelineno-6-25" href="#__codelineno-6-25"></a>        <span class="n">receiver</span><span class="p">:</span> <span class="n">Receiver</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
</span><span id="__span-6-26"><a id="__codelineno-6-26" name="__codelineno-6-26" href="#__codelineno-6-26"></a>        <span class="n">output</span><span class="p">:</span> <span class="n">Sender</span><span class="p">[</span><span class="nb">str</span><span class="p">],</span>
</span><span id="__span-6-27"><a id="__codelineno-6-27" name="__codelineno-6-27" href="#__codelineno-6-27"></a>        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-6-28"><a id="__codelineno-6-28" name="__codelineno-6-28" href="#__codelineno-6-28"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-6-29"><a id="__codelineno-6-29" name="__codelineno-6-29" href="#__codelineno-6-29"></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
</span><span id="__span-6-30"><a id="__codelineno-6-30" name="__codelineno-6-30" href="#__codelineno-6-30"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_receiver</span> <span class="o">=</span> <span class="n">receiver</span>
</span><span id="__span-6-31"><a id="__codelineno-6-31" name="__codelineno-6-31" href="#__codelineno-6-31"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_output</span> <span class="o">=</span> <span class="n">output</span>
</span><span id="__span-6-32"><a id="__codelineno-6-32" name="__codelineno-6-32" href="#__codelineno-6-32"></a>
</span><span id="__span-6-33"><a id="__codelineno-6-33" name="__codelineno-6-33" href="#__codelineno-6-33"></a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">_run</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-6-34"><a id="__codelineno-6-34" name="__codelineno-6-34" href="#__codelineno-6-34"></a>        <span class="k">async</span> <span class="k">for</span> <span class="n">msg</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_receiver</span><span class="p">:</span>
</span><span id="__span-6-35"><a id="__codelineno-6-35" name="__codelineno-6-35" href="#__codelineno-6-35"></a>            <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_output</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Actor2 forwarding: </span><span class="si">{</span><span class="n">msg</span><span class="si">!r}</span><span class="s2">&quot;</span><span class="p">)</span>  <span class="c1"># (9)!</span>
</span><span id="__span-6-36"><a id="__codelineno-6-36" name="__codelineno-6-36" href="#__codelineno-6-36"></a>
</span><span id="__span-6-37"><a id="__codelineno-6-37" name="__codelineno-6-37" href="#__codelineno-6-37"></a>
</span><span id="__span-6-38"><a id="__codelineno-6-38" name="__codelineno-6-38" href="#__codelineno-6-38"></a><span class="k">async</span> <span class="k">def</span> <span class="nf">main</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># (2)!</span>
</span><span id="__span-6-39"><a id="__codelineno-6-39" name="__codelineno-6-39" href="#__codelineno-6-39"></a>    <span class="c1"># (4)!</span>
</span><span id="__span-6-40"><a id="__codelineno-6-40" name="__codelineno-6-40" href="#__codelineno-6-40"></a>    <span class="n">input_channel</span><span class="p">:</span> <span class="n">Broadcast</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">Broadcast</span><span class="p">(</span><span class="s2">&quot;Input to Actor1&quot;</span><span class="p">)</span>
</span><span id="__span-6-41"><a id="__codelineno-6-41" name="__codelineno-6-41" href="#__codelineno-6-41"></a>    <span class="n">middle_channel</span><span class="p">:</span> <span class="n">Broadcast</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">Broadcast</span><span class="p">(</span><span class="s2">&quot;Actor1 -&gt; Actor2 stream&quot;</span><span class="p">)</span>
</span><span id="__span-6-42"><a id="__codelineno-6-42" name="__codelineno-6-42" href="#__codelineno-6-42"></a>    <span class="n">output_channel</span><span class="p">:</span> <span class="n">Broadcast</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">Broadcast</span><span class="p">(</span><span class="s2">&quot;Actor2 output&quot;</span><span class="p">)</span>
</span><span id="__span-6-43"><a id="__codelineno-6-43" name="__codelineno-6-43" href="#__codelineno-6-43"></a>
</span><span id="__span-6-44"><a id="__codelineno-6-44" name="__codelineno-6-44" href="#__codelineno-6-44"></a>    <span class="n">input_sender</span> <span class="o">=</span> <span class="n">input_channel</span><span class="o">.</span><span class="n">new_sender</span><span class="p">()</span>
</span><span id="__span-6-45"><a id="__codelineno-6-45" name="__codelineno-6-45" href="#__codelineno-6-45"></a>    <span class="n">output_receiver</span> <span class="o">=</span> <span class="n">output_channel</span><span class="o">.</span><span class="n">new_receiver</span><span class="p">()</span>
</span><span id="__span-6-46"><a id="__codelineno-6-46" name="__codelineno-6-46" href="#__codelineno-6-46"></a>
</span><span id="__span-6-47"><a id="__codelineno-6-47" name="__codelineno-6-47" href="#__codelineno-6-47"></a>    <span class="k">async</span> <span class="k">with</span> <span class="p">(</span>  <span class="c1"># (5)!</span>
</span><span id="__span-6-48"><a id="__codelineno-6-48" name="__codelineno-6-48" href="#__codelineno-6-48"></a>        <span class="n">Actor1</span><span class="p">(</span><span class="n">input_channel</span><span class="o">.</span><span class="n">new_receiver</span><span class="p">(),</span> <span class="n">middle_channel</span><span class="o">.</span><span class="n">new_sender</span><span class="p">(),</span> <span class="s2">&quot;actor1&quot;</span><span class="p">),</span>
</span><span id="__span-6-49"><a id="__codelineno-6-49" name="__codelineno-6-49" href="#__codelineno-6-49"></a>        <span class="n">Actor2</span><span class="p">(</span><span class="n">middle_channel</span><span class="o">.</span><span class="n">new_receiver</span><span class="p">(),</span> <span class="n">output_channel</span><span class="o">.</span><span class="n">new_sender</span><span class="p">(),</span> <span class="s2">&quot;actor2&quot;</span><span class="p">),</span>
</span><span id="__span-6-50"><a id="__codelineno-6-50" name="__codelineno-6-50" href="#__codelineno-6-50"></a>    <span class="p">):</span>
</span><span id="__span-6-51"><a id="__codelineno-6-51" name="__codelineno-6-51" href="#__codelineno-6-51"></a>        <span class="k">await</span> <span class="n">input_sender</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="s2">&quot;Hello&quot;</span><span class="p">)</span>  <span class="c1"># (6)!</span>
</span><span id="__span-6-52"><a id="__codelineno-6-52" name="__codelineno-6-52" href="#__codelineno-6-52"></a>        <span class="n">msg</span> <span class="o">=</span> <span class="k">await</span> <span class="n">output_receiver</span><span class="o">.</span><span class="n">receive</span><span class="p">()</span>  <span class="c1"># (7)!</span>
</span><span id="__span-6-53"><a id="__codelineno-6-53" name="__codelineno-6-53" href="#__codelineno-6-53"></a>        <span class="nb">print</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>  <span class="c1"># (10)!</span>
</span><span id="__span-6-54"><a id="__codelineno-6-54" name="__codelineno-6-54" href="#__codelineno-6-54"></a>    <span class="c1"># (11)!</span>
</span><span id="__span-6-55"><a id="__codelineno-6-55" name="__codelineno-6-55" href="#__codelineno-6-55"></a>
</span><span id="__span-6-56"><a id="__codelineno-6-56" name="__codelineno-6-56" href="#__codelineno-6-56"></a><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>  <span class="c1"># (3)!</span>
</span><span id="__span-6-57"><a id="__codelineno-6-57" name="__codelineno-6-57" href="#__codelineno-6-57"></a>    <span class="n">asyncio</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">main</span><span class="p">())</span>
</span></code></pre></div>
<ol>
<li>
<p>We define 2 actors: <code>Actor1</code> and <code>Actor2</code> that will just forward a message
   from an input channel to an output channel, adding some text.</p>
</li>
<li>
<p>We define an async <code>main()</code> function within the main logic of our <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/asyncio.html#module-asyncio">asyncio</a> program.</p>
</li>
<li>
<p>We start the <code>main()</code> function in the async loop using <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/asyncio-runner.html#asyncio.run"><code>asyncio.run()</code></a>.</p>
</li>
<li>
<p>We create a bunch of <a class="autorefs autorefs-external" href="https://frequenz-floss.github.io/frequenz-channels-python/v0.16/reference/frequenz/channels/#frequenz.channels.Broadcast">broadcast</a>
   <a class="autorefs autorefs-external" href="https://frequenz-floss.github.io/frequenz-channels-python/v0.16/reference/frequenz/channels/#frequenz.channels">channels</a> to connect our actors.</p>
<ul>
<li><code>input_channel</code> is the input channel for <code>Actor1</code>.</li>
<li><code>middle_channel</code> is the channel that connects <code>Actor1</code> and <code>Actor2</code>.</li>
<li><code>output_channel</code> is the output channel for <code>Actor2</code>.</li>
</ul>
</li>
<li>
<p>We create two actors and use them as async context managers, <code>Actor1</code> and
    <code>Actor2</code>, and connect them by creating new
    <a class="autorefs autorefs-external" href="https://frequenz-floss.github.io/frequenz-channels-python/v0.16/reference/frequenz/channels/#frequenz.channels.Sender">senders</a> and
    <a class="autorefs autorefs-external" href="https://frequenz-floss.github.io/frequenz-channels-python/v0.16/reference/frequenz/channels/#frequenz.channels.Receiver">receivers</a> from the channels.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>We don't use the <a class="autorefs autorefs-internal" href="../../reference/frequenz/sdk/actor/#frequenz.sdk.actor.run"><code>run()</code></a> function here because we
want to stop the actors when we are done with them, but the actors will run
forever (as long as the channel is not closed). So the async context manager
is a better fit for this example.</p>
</div>
</li>
<li>
<p>We schedule the <a class="autorefs autorefs-external" href="https://frequenz-floss.github.io/frequenz-channels-python/v0.16/reference/frequenz/channels/#frequenz.channels.Sender.send">sending</a> of the message
   <code>Hello</code> to <code>Actor1</code> via <code>input_channel</code>.</p>
</li>
<li>
<p>We <a class="autorefs autorefs-external" href="https://frequenz-floss.github.io/frequenz-channels-python/v0.16/reference/frequenz/channels/#frequenz.channels.Receiver.receive">receive</a> (await) the response from
   <code>Actor2</code> via <code>output_channel</code>. Between this and the previous steps the
   <code>async</code> calls in the actors will be executed.</p>
</li>
<li>
<p><code>Actor1</code> sends the re-formatted message (<code>Actor1 forwarding: Hello</code>) to
   <code>Actor2</code> via the <code>middle_channel</code>.</p>
</li>
<li>
<p><code>Actor2</code> sends the re-formatted message (<code>Actor2 forwarding: "Actor1
   forwarding: 'Hello'"</code>) to the <code>output_channel</code>.</p>
</li>
<li>
<p>Finally, we print the received message, which will still be <code>Actor2
    forwarding: "Actor1 forwarding: 'Hello'"</code>.</p>
</li>
<li>
<p>The actors are stopped and cleaned up automatically when the <code>async with</code>
    block ends.</p>
</li>
</ol>
<p>The expected output is:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>Actor2 forwarding: &quot;Actor1 forwarding: &#39;Hello&#39;&quot;
</span></code></pre></div>
<h5 id="frequenz.sdk.actor--receiving-from-multiple-channels">Receiving from multiple channels<a class="headerlink" href="#frequenz.sdk.actor--receiving-from-multiple-channels" title="Permanent link">¤</a></h5>
<p>This example shows how to create an actor that receives messages from multiple
<a class="autorefs autorefs-external" href="https://frequenz-floss.github.io/frequenz-channels-python/v0.16/reference/frequenz/channels/#frequenz.channels.Broadcast">broadcast</a> channels using
<a class="autorefs autorefs-external" href="https://frequenz-floss.github.io/frequenz-channels-python/v0.16/reference/frequenz/channels/util/#frequenz.channels.util.select"><code>select()</code></a>.</p>
<div class="language-python highlight"><span class="filename">select.py</span><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="kn">import</span> <span class="nn">asyncio</span>
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a>
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a><span class="kn">from</span> <span class="nn">frequenz.channels</span> <span class="kn">import</span> <span class="n">Broadcast</span><span class="p">,</span> <span class="n">Receiver</span><span class="p">,</span> <span class="n">Sender</span>
</span><span id="__span-8-4"><a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a><span class="kn">from</span> <span class="nn">frequenz.channels.util</span> <span class="kn">import</span> <span class="n">select</span><span class="p">,</span> <span class="n">selected_from</span>
</span><span id="__span-8-5"><a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a><span class="kn">from</span> <span class="nn">frequenz.sdk.actor</span> <span class="kn">import</span> <span class="n">Actor</span><span class="p">,</span> <span class="n">run</span>
</span><span id="__span-8-6"><a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a>
</span><span id="__span-8-7"><a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a>
</span><span id="__span-8-8"><a id="__codelineno-8-8" name="__codelineno-8-8" href="#__codelineno-8-8"></a><span class="k">class</span> <span class="nc">EchoActor</span><span class="p">(</span><span class="n">Actor</span><span class="p">):</span>  <span class="c1"># (1)!</span>
</span><span id="__span-8-9"><a id="__codelineno-8-9" name="__codelineno-8-9" href="#__codelineno-8-9"></a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
</span><span id="__span-8-10"><a id="__codelineno-8-10" name="__codelineno-8-10" href="#__codelineno-8-10"></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="__span-8-11"><a id="__codelineno-8-11" name="__codelineno-8-11" href="#__codelineno-8-11"></a>        <span class="n">receiver_1</span><span class="p">:</span> <span class="n">Receiver</span><span class="p">[</span><span class="nb">bool</span><span class="p">],</span>
</span><span id="__span-8-12"><a id="__codelineno-8-12" name="__codelineno-8-12" href="#__codelineno-8-12"></a>        <span class="n">receiver_2</span><span class="p">:</span> <span class="n">Receiver</span><span class="p">[</span><span class="nb">bool</span><span class="p">],</span>
</span><span id="__span-8-13"><a id="__codelineno-8-13" name="__codelineno-8-13" href="#__codelineno-8-13"></a>        <span class="n">output</span><span class="p">:</span> <span class="n">Sender</span><span class="p">[</span><span class="nb">bool</span><span class="p">],</span>
</span><span id="__span-8-14"><a id="__codelineno-8-14" name="__codelineno-8-14" href="#__codelineno-8-14"></a>        <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="__span-8-15"><a id="__codelineno-8-15" name="__codelineno-8-15" href="#__codelineno-8-15"></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="__span-8-16"><a id="__codelineno-8-16" name="__codelineno-8-16" href="#__codelineno-8-16"></a>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
</span><span id="__span-8-17"><a id="__codelineno-8-17" name="__codelineno-8-17" href="#__codelineno-8-17"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_receiver_1</span> <span class="o">=</span> <span class="n">receiver_1</span>
</span><span id="__span-8-18"><a id="__codelineno-8-18" name="__codelineno-8-18" href="#__codelineno-8-18"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_receiver_2</span> <span class="o">=</span> <span class="n">receiver_2</span>
</span><span id="__span-8-19"><a id="__codelineno-8-19" name="__codelineno-8-19" href="#__codelineno-8-19"></a>        <span class="bp">self</span><span class="o">.</span><span class="n">_output</span> <span class="o">=</span> <span class="n">output</span>
</span><span id="__span-8-20"><a id="__codelineno-8-20" name="__codelineno-8-20" href="#__codelineno-8-20"></a>
</span><span id="__span-8-21"><a id="__codelineno-8-21" name="__codelineno-8-21" href="#__codelineno-8-21"></a>    <span class="k">async</span> <span class="k">def</span> <span class="nf">_run</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># (2)!</span>
</span><span id="__span-8-22"><a id="__codelineno-8-22" name="__codelineno-8-22" href="#__codelineno-8-22"></a>        <span class="k">async</span> <span class="k">for</span> <span class="n">selected</span> <span class="ow">in</span> <span class="n">select</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_receiver_1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_receiver_2</span><span class="p">):</span>  <span class="c1"># (10)!</span>
</span><span id="__span-8-23"><a id="__codelineno-8-23" name="__codelineno-8-23" href="#__codelineno-8-23"></a>            <span class="k">if</span> <span class="n">selected_from</span><span class="p">(</span><span class="n">selected</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_receiver_1</span><span class="p">):</span>  <span class="c1"># (11)!</span>
</span><span id="__span-8-24"><a id="__codelineno-8-24" name="__codelineno-8-24" href="#__codelineno-8-24"></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Received from receiver_1: </span><span class="si">{</span><span class="n">selected</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-8-25"><a id="__codelineno-8-25" name="__codelineno-8-25" href="#__codelineno-8-25"></a>                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_output</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">selected</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</span><span id="__span-8-26"><a id="__codelineno-8-26" name="__codelineno-8-26" href="#__codelineno-8-26"></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">selected</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>  <span class="c1"># (12)!</span>
</span><span id="__span-8-27"><a id="__codelineno-8-27" name="__codelineno-8-27" href="#__codelineno-8-27"></a>                    <span class="k">break</span>
</span><span id="__span-8-28"><a id="__codelineno-8-28" name="__codelineno-8-28" href="#__codelineno-8-28"></a>            <span class="k">elif</span> <span class="n">selected_from</span><span class="p">(</span><span class="n">selected</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_receiver_2</span><span class="p">):</span>  <span class="c1"># (13)!</span>
</span><span id="__span-8-29"><a id="__codelineno-8-29" name="__codelineno-8-29" href="#__codelineno-8-29"></a>                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Received from receiver_2: </span><span class="si">{</span><span class="n">selected</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-8-30"><a id="__codelineno-8-30" name="__codelineno-8-30" href="#__codelineno-8-30"></a>                <span class="k">await</span> <span class="bp">self</span><span class="o">.</span><span class="n">_output</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">selected</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</span><span id="__span-8-31"><a id="__codelineno-8-31" name="__codelineno-8-31" href="#__codelineno-8-31"></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">selected</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>  <span class="c1"># (14)!</span>
</span><span id="__span-8-32"><a id="__codelineno-8-32" name="__codelineno-8-32" href="#__codelineno-8-32"></a>                    <span class="k">break</span>
</span><span id="__span-8-33"><a id="__codelineno-8-33" name="__codelineno-8-33" href="#__codelineno-8-33"></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="__span-8-34"><a id="__codelineno-8-34" name="__codelineno-8-34" href="#__codelineno-8-34"></a>                <span class="k">assert</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;Unknown selected channel&quot;</span>
</span><span id="__span-8-35"><a id="__codelineno-8-35" name="__codelineno-8-35" href="#__codelineno-8-35"></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;EchoActor finished&quot;</span><span class="p">)</span>
</span><span id="__span-8-36"><a id="__codelineno-8-36" name="__codelineno-8-36" href="#__codelineno-8-36"></a>    <span class="c1"># (15)!</span>
</span><span id="__span-8-37"><a id="__codelineno-8-37" name="__codelineno-8-37" href="#__codelineno-8-37"></a>
</span><span id="__span-8-38"><a id="__codelineno-8-38" name="__codelineno-8-38" href="#__codelineno-8-38"></a>
</span><span id="__span-8-39"><a id="__codelineno-8-39" name="__codelineno-8-39" href="#__codelineno-8-39"></a><span class="c1"># (3)!</span>
</span><span id="__span-8-40"><a id="__codelineno-8-40" name="__codelineno-8-40" href="#__codelineno-8-40"></a><span class="n">input_channel_1</span> <span class="o">=</span> <span class="n">Broadcast</span><span class="p">[</span><span class="nb">bool</span><span class="p">](</span><span class="s2">&quot;input_channel_1&quot;</span><span class="p">)</span>
</span><span id="__span-8-41"><a id="__codelineno-8-41" name="__codelineno-8-41" href="#__codelineno-8-41"></a><span class="n">input_channel_2</span> <span class="o">=</span> <span class="n">Broadcast</span><span class="p">[</span><span class="nb">bool</span><span class="p">](</span><span class="s2">&quot;input_channel_2&quot;</span><span class="p">)</span>
</span><span id="__span-8-42"><a id="__codelineno-8-42" name="__codelineno-8-42" href="#__codelineno-8-42"></a><span class="n">echo_channel</span> <span class="o">=</span> <span class="n">Broadcast</span><span class="p">[</span><span class="nb">bool</span><span class="p">](</span><span class="s2">&quot;echo_channel&quot;</span><span class="p">)</span>
</span><span id="__span-8-43"><a id="__codelineno-8-43" name="__codelineno-8-43" href="#__codelineno-8-43"></a>
</span><span id="__span-8-44"><a id="__codelineno-8-44" name="__codelineno-8-44" href="#__codelineno-8-44"></a><span class="n">echo_actor</span> <span class="o">=</span> <span class="n">EchoActor</span><span class="p">(</span>  <span class="c1"># (4)!</span>
</span><span id="__span-8-45"><a id="__codelineno-8-45" name="__codelineno-8-45" href="#__codelineno-8-45"></a>    <span class="n">input_channel_1</span><span class="o">.</span><span class="n">new_receiver</span><span class="p">(),</span>
</span><span id="__span-8-46"><a id="__codelineno-8-46" name="__codelineno-8-46" href="#__codelineno-8-46"></a>    <span class="n">input_channel_2</span><span class="o">.</span><span class="n">new_receiver</span><span class="p">(),</span>
</span><span id="__span-8-47"><a id="__codelineno-8-47" name="__codelineno-8-47" href="#__codelineno-8-47"></a>    <span class="n">echo_channel</span><span class="o">.</span><span class="n">new_sender</span><span class="p">(),</span>
</span><span id="__span-8-48"><a id="__codelineno-8-48" name="__codelineno-8-48" href="#__codelineno-8-48"></a>    <span class="s2">&quot;echo-actor&quot;</span><span class="p">,</span>
</span><span id="__span-8-49"><a id="__codelineno-8-49" name="__codelineno-8-49" href="#__codelineno-8-49"></a><span class="p">)</span>
</span><span id="__span-8-50"><a id="__codelineno-8-50" name="__codelineno-8-50" href="#__codelineno-8-50"></a>
</span><span id="__span-8-51"><a id="__codelineno-8-51" name="__codelineno-8-51" href="#__codelineno-8-51"></a><span class="n">echo_receiver</span> <span class="o">=</span> <span class="n">echo_channel</span><span class="o">.</span><span class="n">new_receiver</span><span class="p">()</span>  <span class="c1"># (5)!</span>
</span><span id="__span-8-52"><a id="__codelineno-8-52" name="__codelineno-8-52" href="#__codelineno-8-52"></a>
</span><span id="__span-8-53"><a id="__codelineno-8-53" name="__codelineno-8-53" href="#__codelineno-8-53"></a><span class="k">async</span> <span class="k">def</span> <span class="nf">main</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># (6)!</span>
</span><span id="__span-8-54"><a id="__codelineno-8-54" name="__codelineno-8-54" href="#__codelineno-8-54"></a>    <span class="c1"># (8)!</span>
</span><span id="__span-8-55"><a id="__codelineno-8-55" name="__codelineno-8-55" href="#__codelineno-8-55"></a>    <span class="k">await</span> <span class="n">input_channel_1</span><span class="o">.</span><span class="n">new_sender</span><span class="p">()</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</span><span id="__span-8-56"><a id="__codelineno-8-56" name="__codelineno-8-56" href="#__codelineno-8-56"></a>    <span class="k">await</span> <span class="n">input_channel_2</span><span class="o">.</span><span class="n">new_sender</span><span class="p">()</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
</span><span id="__span-8-57"><a id="__codelineno-8-57" name="__codelineno-8-57" href="#__codelineno-8-57"></a>
</span><span id="__span-8-58"><a id="__codelineno-8-58" name="__codelineno-8-58" href="#__codelineno-8-58"></a>    <span class="k">await</span> <span class="n">run</span><span class="p">(</span><span class="n">echo_actor</span><span class="p">)</span>  <span class="c1"># (9)!</span>
</span><span id="__span-8-59"><a id="__codelineno-8-59" name="__codelineno-8-59" href="#__codelineno-8-59"></a>
</span><span id="__span-8-60"><a id="__codelineno-8-60" name="__codelineno-8-60" href="#__codelineno-8-60"></a>    <span class="k">await</span> <span class="n">echo_channel</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>  <span class="c1"># (16)!</span>
</span><span id="__span-8-61"><a id="__codelineno-8-61" name="__codelineno-8-61" href="#__codelineno-8-61"></a>
</span><span id="__span-8-62"><a id="__codelineno-8-62" name="__codelineno-8-62" href="#__codelineno-8-62"></a>    <span class="k">async</span> <span class="k">for</span> <span class="n">message</span> <span class="ow">in</span> <span class="n">echo_receiver</span><span class="p">:</span>  <span class="c1"># (17)!</span>
</span><span id="__span-8-63"><a id="__codelineno-8-63" name="__codelineno-8-63" href="#__codelineno-8-63"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Received </span><span class="si">{</span><span class="n">message</span><span class="si">=}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="__span-8-64"><a id="__codelineno-8-64" name="__codelineno-8-64" href="#__codelineno-8-64"></a>
</span><span id="__span-8-65"><a id="__codelineno-8-65" name="__codelineno-8-65" href="#__codelineno-8-65"></a>
</span><span id="__span-8-66"><a id="__codelineno-8-66" name="__codelineno-8-66" href="#__codelineno-8-66"></a><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>  <span class="c1"># (7)!</span>
</span><span id="__span-8-67"><a id="__codelineno-8-67" name="__codelineno-8-67" href="#__codelineno-8-67"></a>    <span class="n">asyncio</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">main</span><span class="p">())</span>
</span></code></pre></div>
<ol>
<li>
<p>We define an <code>EchoActor</code> that receives messages from two channels and sends
    them to another channel.</p>
</li>
<li>
<p>We implement the <a href="#frequenz.sdk.actor--the-_run-method"><code>_run()</code></a> method that will receive messages from the two
    channels using <a class="autorefs autorefs-external" href="https://frequenz-floss.github.io/frequenz-channels-python/v0.16/reference/frequenz/channels/util/#frequenz.channels.util.select"><code>select()</code></a> and send them to the
    output channel. The <code>run()</code> method will stop if a <code>False</code> message is received.</p>
</li>
<li>
<p>We create the channels that will be used with the actor.</p>
</li>
<li>
<p>We create the actor and connect it to the channels by creating new receivers and
    senders from the channels.</p>
</li>
<li>
<p>We create a receiver for the <code>echo_channel</code> to eventually receive the messages sent
    by the actor.</p>
</li>
<li>
<p>We define the <code>main()</code> function that will run the actor.</p>
</li>
<li>
<p>We start the <code>main()</code> function in the async loop using <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/asyncio-runner.html#asyncio.run"><code>asyncio.run()</code></a>.</p>
</li>
<li>
<p>We send a message to each of the input channels. These messages will be queued in
    the channels until they are consumed by the actor.</p>
</li>
<li>
<p>We start the actor and wait for it to finish using the
    <a class="autorefs autorefs-internal" href="../../reference/frequenz/sdk/actor/#frequenz.sdk.actor.run"><code>run()</code></a> function.</p>
</li>
<li>
<p>The <a class="autorefs autorefs-external" href="https://frequenz-floss.github.io/frequenz-channels-python/v0.16/reference/frequenz/channels/util/#frequenz.channels.util.select"><code>select()</code></a> function will get the first message
    available from the two channels. The order in which they will be handled is
    unknown, but in this example we assume that the first message will be from
    <code>input_channel_1</code> (<code>True</code>) and the second from <code>input_channel_1</code> (<code>False</code>).</p>
</li>
<li>
<p>The <a class="autorefs autorefs-external" href="https://frequenz-floss.github.io/frequenz-channels-python/v0.16/reference/frequenz/channels/util/#frequenz.channels.util.selected_from"><code>selected_from()</code></a> function will return
    <code>True</code> for the <code>input_channel_1</code> receiver. <code>selected.value</code> holds the received
    message, so <code>"Received from receiver_1: True"</code> will be printed and <code>True</code> will be
    sent to the <code>output</code> channel.</p>
</li>
<li>
<p>Since <code>selected.value</code> is <code>True</code>, the loop will continue, going back to the
    <a class="autorefs autorefs-external" href="https://frequenz-floss.github.io/frequenz-channels-python/v0.16/reference/frequenz/channels/util/#frequenz.channels.util.select"><code>select()</code></a> function.</p>
</li>
<li>
<p>The <a class="autorefs autorefs-external" href="https://frequenz-floss.github.io/frequenz-channels-python/v0.16/reference/frequenz/channels/util/#frequenz.channels.util.selected_from"><code>selected_from()</code></a> function will return
    <code>False</code> for the <code>input_channel_1</code> receiver and <code>True</code> for the <code>input_channel_2</code>
    receiver. The message stored in <code>selected.value</code> will now be <code>False</code>, so
    <code>"Received from receiver_2: False"</code> will be printed and <code>False</code> will be sent to the
    <code>output</code> channel.</p>
</li>
<li>
<p>Since <code>selected.value</code> is <code>False</code>, the loop will break.</p>
</li>
<li>
<p>The <a href="#frequenz.sdk.actor--the-_run-method"><code>_run()</code></a> method will finish normally and the actor will be stopped, so
    the <a class="autorefs autorefs-internal" href="../../reference/frequenz/sdk/actor/#frequenz.sdk.actor.run"><code>run()</code></a> function will return.</p>
</li>
<li>
<p>We close the <code>echo_channel</code> to make sure the <code>echo_receiver</code> will stop receiving
    messages after all the queued messages are consumed (otherwise the step 17 will
    never end!).</p>
</li>
<li>
<p>We receive the messages sent by the actor to the <code>echo_channel</code> one by one and print
    them, it should print first <code>Received message=True</code> and then <code>Received
    message=False</code>.</p>
</li>
</ol>
<p>The expected output is:</p>
<div class="language-text highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a>Received from receiver_1: True
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a>Received from receiver_2: False
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a>Received message=True
</span><span id="__span-9-4"><a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a>Received message=False
</span></code></pre></div>



  <div class="doc doc-children">











  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../" class="md-footer__link md-footer__link--prev" aria-label="Previous: Introduction">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Introduction
              </div>
            </div>
          </a>
        
        
          
          <a href="../formula-engine/" class="md-footer__link md-footer__link--next" aria-label="Next: Formula Engine">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Formula Engine
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright © 2022 Frequenz Energy-as-a-Service GmbH
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/frequenz-floss" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.linkedin.com/company/frequenz-com" target="_blank" rel="noopener" title="www.linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["content.code.annotate", "content.code.copy", "navigation.indexes", "navigation.instant", "navigation.footer", "navigation.tabs", "navigation.top", "navigation.tracking", "toc.follow"], "search": "../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"default": "latest", "provider": "mike"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.ad660dcc.min.js"></script>
      
    
  </body>
</html>